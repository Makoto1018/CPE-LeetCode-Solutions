## Problem Title

- **Problem Number**:  626. Exchange Seats
- **Difficulty**: Medium
- **Link**: [LeetCode 問題連結](https://leetcode.com/problems/exchange-seats/description/?envType=study-plan-v2&envId=top-sql-50)
- **是否有先參考別人的觀念**: 有
1. LAG()
2. LEAD()
---

### Problem Description

Write a solution to swap the seat id of every two consecutive students. If the number of students is odd, the id of the last student is not swapped.

Return the result table ordered by id in ascending order.

---

### Approach

1. **思路概述**：如果是奇數，就拿後面一個的名字。如果是偶數，就拿前面一個的名字。最後一個是奇數的話就不用換
2. **關鍵步驟**：用 LAG() 跟 LEAD()
3. **時間複雜度分析**：$O(n)$

---

### Other Solution


---
### Summary

- **學到的新觀念**:
1. 有 MOD() 可以用
2. LEAD(column, 往後看幾位, 找不到該欄位的話的預設值)，看後面row的東西。搭配over使用可以讓他是order by某東西
3. LAG(column)，看前面row的東西。搭配over使用可以讓他是order by某東西
- **遇到的困難點與解法**:

---

### code
1. 用windows function
```sql
SELECT id,
CASE WHEN MOD(id, 2)=1 THEN LEAD(student,1,student) over(ORDER BY id)
ELSE LAG(student) over(ORDER BY id) END
as student
FROM Seat
```

2. SELF JOIN
```sql
SELECT 
    s1.id,
    CASE 
        WHEN MOD(s1.id, 2) = 1 AND s2.student IS NOT NULL THEN s2.student    -- 奇數，抓後面那個人
        WHEN MOD(s1.id, 2) = 0 AND s2.student IS NOT NULL THEN s2.student    -- 偶數，抓前面那個人
        ELSE s1.student                                                      -- 如果s2是NULL，保持原本的學生名
    END AS student
FROM Seat s1
LEFT JOIN Seat s2
  ON (s1.id % 2 = 1 AND s2.id = s1.id + 1)  -- 奇數對偶數
  OR (s1.id % 2 = 0 AND s2.id = s1.id - 1)  -- 偶數對奇數
ORDER BY s1.id;
```