## Problem Title

- **Problem Number**:  1341. Movie Rating
- **Difficulty**: Medium
- **Link**: [LeetCode 問題連結](https://leetcode.com/problems/movie-rating/description/?envType=study-plan-v2&envId=top-sql-50)
- **是否有先參考別人的觀念**: 有，知道要分段做比較方便
---

### Problem Description

Write a solution to:

Find the name of the user who has rated the greatest number of movies. In case of a tie, return the lexicographically smaller user name.
Find the movie name with the highest average rating in February 2020. In case of a tie, return the lexicographically smaller movie name.

---

### Approach

1. **思路概述**：分段分別找出兩個符合條件的資料，然後union all 因為測資很賊還有電影名稱跟人名一樣的
2. **關鍵步驟**：
3. **時間複雜度分析**：$O(n)$

---

### Other Solution


---
### Summary

- **學到的新觀念**: 太複雜的話可以嘗試分段做
- **遇到的困難點與解法**:

---

### code
```sql
SELECT name as results
FROM(
 SELECT name, count(*) as c
 FROM Users as u
 JOIN MovieRating as m
 ON u.user_id = m.user_id
 GROUP BY u.user_id, name
 ORDER BY c desc, u.name asc
 LIMIT 1
)
UNION all
SELECT title as results
FROM(
 SELECT title, avg(rating) as c
 FROM Movies as u
 JOIN MovieRating as m
 ON u.movie_id = m.movie_id and to_char(created_at,'YYYY-MM') = '2020-02'
 GROUP BY u.movie_id, title
 ORDER BY c desc, u.title asc
 LIMIT 1
)
```