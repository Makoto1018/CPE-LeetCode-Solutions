## Problem Title

- **Problem Number**:  1193. Monthly Transactions I
- **Difficulty**: medium
- **Link**: [LeetCode 問題連結](https://leetcode.com/problems/monthly-transactions-i/description/?envType=study-plan-v2&envId=top-sql-50)
- **是否有先參考別人的觀念**:
1. 有，去看了甚麼是date_format()，這是mysql的
2. postgresql 可以用 to_char()
---

### Problem Description

Write an SQL query to find for each month and country, the number of transactions and their total amount, the number of approved transactions and their total amount.

Return the result table in any order.
---

### Approach

1. **思路概述**： 要熟悉 count() 跟 sum() 裡面的 case 寫法
2. **關鍵步驟**：
3. **時間複雜度分析**：$O(n)$

---

### Other Solution

> 其他的解法

---
### Summary

- **學到的新觀念**:
1. to_char() 與 date_format() 的使用
- **遇到的困難點與解法**:
---

### code
1. mySQL
```sql
# Write your MySQL query statement below
SELECT DATE_FORMAT(trans_date, '%Y-%m') as month,
country,
count(*) as trans_count,
count(CASE WHEN state='approved' THEN 1 END) as approved_count,
SUM(amount) as trans_total_amount,
SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) as approved_total_amount
FROM Transactions
GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country;
```

2. postgreSQL
```sql
-- Write your PostgreSQL query statement below
SELECT to_char(trans_date, 'YYYY-mm') as month,
country,
count(*) as trans_count,
count(CASE WHEN state='approved' THEN 1 END) as approved_count,
SUM(amount) as trans_total_amount,
SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) as approved_total_amount
FROM Transactions
GROUP BY to_char(trans_date, 'YYYY-mm'), country;
```