## Problem Title

- **Problem Number**:  1211. Queries Quality and Percentage
- **Difficulty**: easy
- **Link**: [LeetCode 問題連結](https://leetcode.com/problems/queries-quality-and-percentage/description/?envType=study-plan-v2&envId=top-sql-50)
- **是否有先參考別人的觀念**: 有
---

### Problem Description

We define query quality as:

The average of the ratio between query rating and its position.

We also define poor query percentage as:

The percentage of all queries with rating less than 3.

Write a solution to find each query_name, the quality and poor_query_percentage.

Both quality and poor_query_percentage should be rounded to 2 decimal places.

Return the result table in any order.
---

### Approach

1. **思路概述**： 要稍微思考一下count跟sum該怎麼用
2. **關鍵步驟**：
3. **時間複雜度分析**：$O(n)$

---

### Other Solution

> 其他的解法

---
### Summary

- **學到的新觀念**:
1. COUNT() 的裡面條件是NULL以外的都會算進去(+1的意思)
2. SUM(CASE WHEN rating<3 then 1 else 0 end) 這樣的話是指 rating<3 的時候，會算做 1 加上去
- **遇到的困難點與解法**:
---

### code
```sql
SELECT query_name,
ROUND(AVG(rating*1.0/position)::numeric,2) as quality,
ROUND((count(CASE WHEN rating<3 then 1 else null end)*100.0/count(*))::numeric, 2) as poor_query_percentage
FROM Queries
GROUP BY query_name;
```