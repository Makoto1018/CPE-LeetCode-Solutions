## Problem Title

- **Problem Number**:  1204. Last Person to Fit in the Bus
- **Difficulty**: medium
- **Link**: [LeetCode 問題連結](https://leetcode.com/problems/last-person-to-fit-in-the-bus/description/?envType=study-plan-v2&envId=top-sql-50)
- **是否有先參考別人的觀念**:
1. 有，limit
2. sum() over 的觀念
3. 整題的思維
---

### Problem Description

There is a queue of people waiting to board a bus. However, the bus has a weight limit of 1000 kilograms, so there may be some people who cannot board.

Write a solution to find the person_name of the last person that can fit on the bus without exceeding the weight limit. The test cases are generated such that the first person does not exceed the weight limit.

Note that only one person can board the bus at any given turn.
---

### Approach

1. **思路概述**：先用SUM() OVER() 來算出總重量，然後用LIMIT 1 來列出最後一個上車的人
2. **關鍵步驟**：
    - 用`sum(weight) over(order by turn)` 來算出總重量
    - `order by turn desc` 來讓它是從最後上車的開始往前數，`limit 1` 可以印出表格最上面的那一欄
3. **時間複雜度分析**：

---

### Other Solution

> 其他的解法

---
### Summary

- **學到的新觀念**:
1. sum() over 的觀念
2. limit
- **遇到的困難點與解法**:

---

### code
```sql
select person_name from
(
    select person_name, turn, weight, sum(weight) over(order by turn) as total
    from queue
)
where total <= 1000
order by turn desc
limit 1
```